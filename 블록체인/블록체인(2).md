# SSAFY_Daliy_Project

## 200320|Day10|특화 프로젝트

### 이더리움

- 2013년, Vitlik Buterin이 제안한 공개형 블록체인

- 분산 어플리케이션을 위한 플랫폼을 표방

- Blockchlain 2.0
  - 비트코인의 scripting language를 개선, 발전시킨 스마트 컨트랙트
  - 이후 등장한 블록체인들이 스마트 컨트랙트를 핵심요소로 가지게 된 

- 이더
  - 이더리움에서 발행한 암호화폐
  - 거래, 스마트 컨트랙트 비용지불 등 이더리움이 동작하기 위한 것

- 분산화된 상태전이 머신
  - 트랜잭션에 기반한 상태전이
    - 단, 이전 상태로 되돌아갈 수 없음
  - 암호화 알고리즘을 활용 => 무작위로 상태전이가 일어나는 것을 방지
  - 모든 참여자가 동일한 상태를 공유
  - 블록은 해당 시점의 이더리움의 상태를 나타낸다고 볼 수 있음
    - 현재 블록 => 현재 이더리움의 상태
    - Genesis Block(이더리움의 최초 상태) => Block 1=> ... => Block N-1

### 이더리움의 주요한 구성요소들

#### 이더리움 계정의 종류

- 외부 소유 계정
  - ETH 잔액 유지
  - 개인 키를 통한 주소 관리
  - ETH 전송, 컨트랙트 실행을 위한 거래 전송 가능
  - 컨트랙트 코드를 가지고 있지 않음(빈 문자열 hash값)
- 컨트랙트 계정
  - ETH 잔액 유지
  - 주소를 가지고 있으나 개인키는 존재하지 않음
  - 컨트랙트 코드를 보유
  - 거래나 메시지를 수신하면 보유하고 있는 컨트랙트 코드를 실행

- 주소 생성
  - 개인키 생성: 256bit의 무작위 숫자 
  - 64자리의 Hex값으로 인코딩
  - 타원곡선전자서명 알고리즘을 사용하여 공개키 생성
  - 계정 주소생성
- 상태
  - 어느 한 시점에 대한 Ether의 잔액, 기타 정보를 담고 있는 계정들의 집합
  - 모든 이더리움의 참여 노드는 로컬에 상태 정보를 유지함
  - stateObject
    - 상태의 수정이 발생한 이더리움 계정을 나타내는 객체
    - 주요 데이터
      - Address commonAddress => 이더리움 주소
      - addrHash common.hash => 이더리움 주소의 hash 값
      - data Account => 이더리움 계정
      - db *stateDB => 상태를 저장할 DB
      - code Code => 컨트랙트 코드
  - stateObject를 통해 이더리움의 state database인 LevelDB에 업데이트
- 이더리움의 상태 전이
  - 블록 채굴로 인한 거래 내역 추가 시 상태 전이 발생
  - 상태전이함수에 의해 수행
- 트랜잭션
  - 종류
    - 외부트랜잭션
      - EOA가 다른 EOA 혹은 CA로 보내는 '서명된 메시지'
        - EOA => EOA: ETH 잔액 변경(ETH 송금)
        - EOA => CA: 컨트랙트 코드 실행
      - 계정의 상태 변화를 유도하는 일종의 트리거
    - 내부 트랜잭션
      - CA가 다른 CA 혹은 EOA에게 전달하는 '서명되지 않은 메시지'
      - 주로 컨트랙트 함수 호출에 사용
      - 블록체인에 별도로 저장되지 않음
  - 구조
    - 외부 트랜잭션의 수
    - 트랜잭션 수수료
    - 트랜잭션 실행을 위해 지불할 최대 가스양
    - 거래의 수신처
    - 거래하고자 하는 ETH의 양
    - 메시지, 함수 호출 등
    - 서명정보
  - 리시트
    - 트랜잭션의 실행결과를 기록
    - 검색을 위한 인덱스, 해당 트랜잭션이 포함된 블록의 번호 및 해시 등 저장
- 블록
  - 이더리움 장부에 기록되는 데이터의 기본 단위
  - 트랜잭션들의 집합
  - 주요 데이터
    - 이전 블록의 헤더 해시값
    - 이 블록의 엉클블록
    - 이 블록을 채굴한 Miner의 주소
    - MPT의 root값
    - 이 블록에 포함된 트랙잭션들의 머클트리 루트
    - 이 블록에 포함된 트랙잭션 리시트들의 머클트리 루트
    - 로그 정보 관리를 위한 bloom 필터
    - PoW 난이도
    - 이 블록의 번호
    - 이 블록의 최대 가스양
    - 이 블록에 포함된 트랜잭션 실행에 소모된 가스양의 합
    - 이 블록의 최초 생성시간
    - PoW 연산 보장
- 엉클 블록
  - 동일한 시점에 채굴된 블록 중 채굴 난이도가 낮아 메인 체인에 연결되지 못한 블록
  - 블록생성 시간이 빠를 수록 엉클 블록의 발생확률이 높음
    - 비트코인 => 약 10분
    - 이더리움 => 약 14초
  - 문제점
    - 엉클 블록에 포함된 트랜잭션은 승인되지 않았기 때문에 트랜잭션 처리 지연 발생
    - 승인되지 않은 블록에 연산이 소모되어 연산량이 낭비됨
    - 평균 블록생성 시간이 늘어나 채굴 난이도가 감소하게 되어 네티워크의 보안수준이 낮아짐
- 작업증명
  - 비트코인의 PoW의 문제점을 개선
  - ASIC저항성을 높임
  - 계산은 어렵게, 검증은 쉽게
- 지분증명
  - 검증자가 가진 지분에 비례한 확률로 블록 생성 권한을 획득하고 생성된 블록을 원하는 체인에 연결, 보상 획득
  - PoW의 문제점을 개선
    - 전력 소모량, 채굴 중앙화 등
  - 이더리움은 Casper를 통해 PoS로 전환 중

### 스마트 컨트랙트

- 스마트 컨트랙트 개발언어
  - Solidity: 현재 가장 많이 사용되고 있는 이더리움 스마트 컨트랙트 언어
  - SERPENT: 초창기 이더리움의 스마트 컨트랙트 언어
  - LLL: 어셈블리 언어와 유사

